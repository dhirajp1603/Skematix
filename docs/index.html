<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Skematix — Upload Floorplan</title>
    <style>
      body { font-family: Arial, sans-serif; padding: 2rem; }
      #result { margin-top: 1rem; }
    </style>
  </head>
  <body>
    <h2>Skematix — Upload Floorplan</h2>
    <form id="uploadForm">
      <input type="file" name="file" accept="image/*" />
      <button type="submit">Upload</button>
    </form>
    <div id="result"></div>
    <p style="margin-top:12px"><a href="/frontend/viewer.html" target="_blank">Open 3D Viewer</a></p>

    <script>
      const form = document.getElementById('uploadForm');
      const result = document.getElementById('result');
      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        const fd = new FormData(form);
        result.textContent = 'Uploading...';
        const res = await fetch('http://127.0.0.1:5000/upload', { method: 'POST', body: fd });
        const j = await res.json();
        if (res.ok) {
          result.innerHTML = '<pre>' + JSON.stringify(j, null, 2) + '</pre>';
          if (j.gltf) {
            result.innerHTML += '<p>Blender produced: <a href="/output/model.glb">model.glb</a> (serve via backend)</p>';
          }
        } else {
          result.innerHTML = '<pre>' + JSON.stringify(j, null, 2) + '</pre>';
        }
      });
    </script>
  </body>
</html>
